#include <stdio.h>
#include <Windows.h>

// Constructing a new data type that represents HelloWorld's function pointer 
typedef void(WINAPI* HelloWorldFunctionPointer)();

void call() {
    // Attempt to get the handle of the DLL that's already in memory
    HMODULE hModule = GetModuleHandleA("Dll1.dll");
    if (hModule == NULL) {
        // If the DLL is not loaded in memory, use LoadLibrary to load it
        hModule = LoadLibraryA("Dll1.dll");
        if (hModule == NULL) {
            printf("Failed to load Dll1.dll\n");
            return;
        }
    }

    PVOID phelloWorldFunc = GetProcAddress(hModule, "HelloWorld"); // phelloWorldFunc stores HelloWorld's function address
    if (phelloWorldFunc == NULL) {
        printf("Failed to get the address of helloWorld\n");
        return;
    }

    HelloWorldFunctionPointer helloW = (HelloWorldFunctionPointer)phelloWorldFunc;

    // Invoke the function via the function pointer
    helloW();
}

int main() {
    call();
    return 0;
}
